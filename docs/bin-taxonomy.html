<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 14 BIN TAXONOMY | My post-graduate study work</title>
  <meta name="description" content="Section 14 BIN TAXONOMY | My post-graduate study work" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 14 BIN TAXONOMY | My post-graduate study work" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 14 BIN TAXONOMY | My post-graduate study work" />
  
  
  

<meta name="author" content="Karine Villeneuve" />


<meta name="date" content="2020-11-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bin-cleaning.html"/>
<link rel="next" href="phylogenetic-tree.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Research Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i><b>1.1</b> About me</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="host-bookdown-on-github.html"><a href="host-bookdown-on-github.html"><i class="fa fa-check"></i><b>2</b> Host Bookdown on Github</a>
<ul>
<li class="chapter" data-level="2.1" data-path="host-bookdown-on-github.html"><a href="host-bookdown-on-github.html#getting-bookdown-started"><i class="fa fa-check"></i><b>2.1</b> Getting Bookdown started</a></li>
<li class="chapter" data-level="2.2" data-path="host-bookdown-on-github.html"><a href="host-bookdown-on-github.html#github-repository"><i class="fa fa-check"></i><b>2.2</b> Github Repository</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Methods</a></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a>
<ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="6" data-path="cheat-sheet.html"><a href="cheat-sheet.html"><i class="fa fa-check"></i><b>6</b> Cheat sheet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cheat-sheet.html"><a href="cheat-sheet.html#hello-world"><i class="fa fa-check"></i><b>6.1</b> Hello world</a></li>
<li class="chapter" data-level="6.2" data-path="cheat-sheet.html"><a href="cheat-sheet.html#scp"><i class="fa fa-check"></i><b>6.2</b> SCP</a></li>
<li class="chapter" data-level="6.3" data-path="cheat-sheet.html"><a href="cheat-sheet.html#vizbin"><i class="fa fa-check"></i><b>6.3</b> Vizbin</a></li>
<li class="chapter" data-level="6.4" data-path="cheat-sheet.html"><a href="cheat-sheet.html#vi"><i class="fa fa-check"></i><b>6.4</b> vi</a></li>
<li class="chapter" data-level="6.5" data-path="cheat-sheet.html"><a href="cheat-sheet.html#terminal-shortcuts"><i class="fa fa-check"></i><b>6.5</b> Terminal shortcuts</a></li>
<li class="chapter" data-level="6.6" data-path="cheat-sheet.html"><a href="cheat-sheet.html#script-to-remove-sequences-from-a-file"><i class="fa fa-check"></i><b>6.6</b> Script to remove sequences from a file</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scp-1.html"><a href="scp-1.html"><i class="fa fa-check"></i><b>7</b> SCP</a></li>
<li class="chapter" data-level="8" data-path="interleaving.html"><a href="interleaving.html"><i class="fa fa-check"></i><b>8</b> INTERLEAVING</a>
<ul>
<li class="chapter" data-level="8.1" data-path="interleaving.html"><a href="interleaving.html#interleaving-1"><i class="fa fa-check"></i><b>8.1</b> Interleaving</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="interleaving.html"><a href="interleaving.html#run-script"><i class="fa fa-check"></i><b>8.1.1</b> Run script</a></li>
<li class="chapter" data-level="8.1.2" data-path="interleaving.html"><a href="interleaving.html#obtaining-script"><i class="fa fa-check"></i><b>8.1.2</b> Obtaining script</a></li>
<li class="chapter" data-level="8.1.3" data-path="interleaving.html"><a href="interleaving.html#script"><i class="fa fa-check"></i><b>8.1.3</b> Script</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="interleaving.html"><a href="interleaving.html#sickle"><i class="fa fa-check"></i><b>8.2</b> Sickle</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="interleaving.html"><a href="interleaving.html#about"><i class="fa fa-check"></i><b>8.2.1</b> About</a></li>
<li class="chapter" data-level="8.2.2" data-path="interleaving.html"><a href="interleaving.html#exemple"><i class="fa fa-check"></i><b>8.2.2</b> Exemple</a></li>
<li class="chapter" data-level="8.2.3" data-path="interleaving.html"><a href="interleaving.html#bash-script"><i class="fa fa-check"></i><b>8.2.3</b> Bash script</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="interleaving.html"><a href="interleaving.html#quality-check-with-fastqc"><i class="fa fa-check"></i><b>8.3</b> Quality Check with Fastqc</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="interleaving.html"><a href="interleaving.html#about-1"><i class="fa fa-check"></i><b>8.3.1</b> About</a></li>
<li class="chapter" data-level="8.3.2" data-path="interleaving.html"><a href="interleaving.html#exemple-1"><i class="fa fa-check"></i><b>8.3.2</b> Exemple</a></li>
<li class="chapter" data-level="8.3.3" data-path="interleaving.html"><a href="interleaving.html#bash"><i class="fa fa-check"></i><b>8.3.3</b> Bash</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="interleaving.html"><a href="interleaving.html#fastq-to-fasta-with-seqtk"><i class="fa fa-check"></i><b>8.4</b> Fastq to fasta with seqtk</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="assembly.html"><a href="assembly.html"><i class="fa fa-check"></i><b>9</b> ASSEMBLY</a>
<ul>
<li class="chapter" data-level="9.1" data-path="assembly.html"><a href="assembly.html#idba"><i class="fa fa-check"></i><b>9.1</b> IDBA</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="assembly.html"><a href="assembly.html#about-2"><i class="fa fa-check"></i><b>9.1.1</b> About</a></li>
<li class="chapter" data-level="9.1.2" data-path="assembly.html"><a href="assembly.html#bash-script-1"><i class="fa fa-check"></i><b>9.1.2</b> Bash script</a></li>
<li class="chapter" data-level="9.1.3" data-path="assembly.html"><a href="assembly.html#exemple-2"><i class="fa fa-check"></i><b>9.1.3</b> Exemple</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="assembly.html"><a href="assembly.html#megahit"><i class="fa fa-check"></i><b>9.2</b> Megahit</a></li>
<li class="chapter" data-level="9.3" data-path="assembly.html"><a href="assembly.html#metaspades"><i class="fa fa-check"></i><b>9.3</b> metaSPAdes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html"><i class="fa fa-check"></i><b>10</b> POST ASSEMBLY STATS</a>
<ul>
<li class="chapter" data-level="10.1" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#number-of-contigs"><i class="fa fa-check"></i><b>10.1</b> Number of contigs</a></li>
<li class="chapter" data-level="10.2" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#lenght-of-contigs"><i class="fa fa-check"></i><b>10.2</b> Lenght of contigs</a></li>
<li class="chapter" data-level="10.3" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#histogram"><i class="fa fa-check"></i><b>10.3</b> Histogram</a></li>
<li class="chapter" data-level="10.4" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#lenght-and-gc"><i class="fa fa-check"></i><b>10.4</b> Lenght and GC</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#run-the-script"><i class="fa fa-check"></i><b>10.4.1</b> Run the script</a></li>
<li class="chapter" data-level="10.4.2" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#obtainning-script-from-midgard"><i class="fa fa-check"></i><b>10.4.2</b> obtainning script from Midgard</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#keeping-sequence-above-2000kb"><i class="fa fa-check"></i><b>10.5</b> Keeping sequence above 2000kb</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="binning.html"><a href="binning.html"><i class="fa fa-check"></i><b>11</b> BINNING</a>
<ul>
<li class="chapter" data-level="11.1" data-path="binning.html"><a href="binning.html#mapping"><i class="fa fa-check"></i><b>11.1</b> Mapping</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="binning.html"><a href="binning.html#ve"><i class="fa fa-check"></i><b>11.1.1</b> VE</a></li>
<li class="chapter" data-level="11.1.2" data-path="binning.html"><a href="binning.html#manual"><i class="fa fa-check"></i><b>11.1.2</b> manual</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="binning.html"><a href="binning.html#depth-file"><i class="fa fa-check"></i><b>11.2</b> Depth file</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="binning.html"><a href="binning.html#run-the-script-1"><i class="fa fa-check"></i><b>11.2.1</b> Run the script</a></li>
<li class="chapter" data-level="11.2.2" data-path="binning.html"><a href="binning.html#copy-file-from-midgard-to-asgard"><i class="fa fa-check"></i><b>11.2.2</b> Copy file from Midgard to Asgard</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="binning.html"><a href="binning.html#metabat"><i class="fa fa-check"></i><b>11.3</b> MetaBAT</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bin-quality.html"><a href="bin-quality.html"><i class="fa fa-check"></i><b>12</b> BIN QUALITY</a></li>
<li class="chapter" data-level="13" data-path="bin-cleaning.html"><a href="bin-cleaning.html"><i class="fa fa-check"></i><b>13</b> BIN CLEANING</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bin-cleaning.html"><a href="bin-cleaning.html#mm-genome"><i class="fa fa-check"></i><b>13.1</b> MM Genome</a></li>
<li class="chapter" data-level="13.2" data-path="bin-cleaning.html"><a href="bin-cleaning.html#vizbin-1"><i class="fa fa-check"></i><b>13.2</b> Vizbin</a></li>
<li class="chapter" data-level="13.3" data-path="bin-cleaning.html"><a href="bin-cleaning.html#depth-file-1"><i class="fa fa-check"></i><b>13.3</b> Depth file</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html"><i class="fa fa-check"></i><b>14</b> BIN TAXONOMY</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html#barrnap"><i class="fa fa-check"></i><b>14.1</b> Barrnap</a></li>
<li class="chapter" data-level="14.2" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html#gtdbtk"><i class="fa fa-check"></i><b>14.2</b> GTDBTK</a></li>
<li class="chapter" data-level="14.3" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html#onecodex"><i class="fa fa-check"></i><b>14.3</b> OneCodeX</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html"><i class="fa fa-check"></i><b>15</b> PHYLOGENETIC TREE</a>
<ul>
<li class="chapter" data-level="15.1" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#download-reference-genomes"><i class="fa fa-check"></i><b>15.1</b> Download reference genomes</a></li>
<li class="chapter" data-level="15.2" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#phylosift"><i class="fa fa-check"></i><b>15.2</b> Phylosift</a></li>
<li class="chapter" data-level="15.3" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#geneious"><i class="fa fa-check"></i><b>15.3</b> Geneious</a></li>
<li class="chapter" data-level="15.4" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#raxml"><i class="fa fa-check"></i><b>15.4</b> RAxML</a></li>
<li class="chapter" data-level="15.5" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#itol"><i class="fa fa-check"></i><b>15.5</b> iTOL</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html"><i class="fa fa-check"></i><b>16</b> METABOLIC PATHWAY</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#convert-bins-to-protein-.faa"><i class="fa fa-check"></i><b>16.1</b> Convert bins to protein (.faa)</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#kofamkoala"><i class="fa fa-check"></i><b>16.1.1</b> KofamKoala</a></li>
<li class="chapter" data-level="16.1.2" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#hyddb"><i class="fa fa-check"></i><b>16.1.2</b> HydDB</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#hydrogenase-tree"><i class="fa fa-check"></i><b>16.2</b> Hydrogenase tree</a></li>
<li class="chapter" data-level="16.3" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#mebs"><i class="fa fa-check"></i><b>16.3</b> Mebs</a></li>
<li class="chapter" data-level="16.4" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#metabolic"><i class="fa fa-check"></i><b>16.4</b> Metabolic</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="other-stuff.html"><a href="other-stuff.html"><i class="fa fa-check"></i><b>17</b> Other Stuff</a>
<ul>
<li class="chapter" data-level="17.1" data-path="other-stuff.html"><a href="other-stuff.html#one-file"><i class="fa fa-check"></i><b>17.1</b> One file</a></li>
<li class="chapter" data-level="17.2" data-path="other-stuff.html"><a href="other-stuff.html#bash-script-2"><i class="fa fa-check"></i><b>17.2</b> Bash script</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My post-graduate study work</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bin-taxonomy" class="section level1 tabset" number="14">
<h1><span class="header-section-number">Section 14</span> BIN TAXONOMY</h1>
<div id="barrnap" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Barrnap</h2>
<ol style="list-style-type: lower-alpha">
<li>Copy all your cleaned bins into a new foler called cleaned_bins</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="bin-taxonomy.html#cb72-1"></a><span class="fu">cp</span> *.fa cleaned_bins/</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>We want to add the name of the bin to the beginning of every file and change the file type to <code>.fna</code>. Use this perl script :</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb73-1"><a href="bin-taxonomy.html#cb73-1"></a><span class="kw">for</span> <span class="ex">i</span> in *.fa <span class="kw">;</span> <span class="kw">do</span>  <span class="fu">perl</span> -lne <span class="st">&#39;if(/^&gt;(\S+)/){ print &quot;&gt;$ARGV $1&quot;} else{ print }&#39;</span> <span class="va">$i</span> <span class="op">&gt;</span> <span class="va">$i</span>.fna <span class="kw">;</span> <span class="kw">done</span></span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>In each of your file, change the space between the name and the scaffhold numer to an underscore</li>
</ol>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb74-1"><a href="bin-taxonomy.html#cb74-1"></a><span class="fu">sed</span> -i <span class="st">&#39;s/ /_/g&#39;</span> *.fna</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li><p>Move all the <code>.fna</code>to a new directory (<code>mkir fna</code>)</p></li>
<li><p>Concatenate all the <code>.fna</code> files in one document with the following command</p></li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb75-1"><a href="bin-taxonomy.html#cb75-1"></a><span class="fu">cat</span> *.fna <span class="op">&gt;</span> all_bins.fna </span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Use barrnap to identify the scaffholds that have partial or complet 16S gene</li>
</ol>
<div class="sourceCode" id="cb76"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb76-1"><a href="bin-taxonomy.html#cb76-1"></a><span class="ex">barrnap</span> all_bins.fna <span class="op">&gt;</span> barrnap_hits.txt</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb77-1"><a href="bin-taxonomy.html#cb77-1"></a><span class="ex">barrnap</span> --kingdom arc --lencutoff 0.2 --reject 0.3 --evalue 1e-05 all_bins.fna <span class="op">&gt;</span> barrnap_archaea.txt</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb78-1"><a href="bin-taxonomy.html#cb78-1"></a><span class="ex">barrnap</span> --kingdom bac --lencutoff 0.2 --reject 0.3 --evalue 1e-05 all_bins.fna <span class="op">&gt;</span> barrnap_bacteria.txt</span></code></pre></div>
<p>Opening the txt file will show you which scaffholds in which contigs have complete or near complete 16S rRNA.</p>
<p>In our case, the bin.40 bin.40_1.fa_contig-115_1168 had the 16S. Therefor, we manually copied the sequence and pasted it in Blast ti identify the organism to which this sequence belonged.</p>
<hr />
<p>To obtain more sequences, we ran barrnap on the inital 2000kb.fa file. We obtained 11 scaffholds containing 16S.</p>
<p>We copied the name of those scaffhold followed by the coordinates of the 16S gene in a vi file named scaff. Example : contig-115_1168:1-955</p>
<p>The following command was then used to copy the sequence identified in the vi scaff file into a new file name 16S_2KB.fna</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb79-1"><a href="bin-taxonomy.html#cb79-1"></a><span class="kw">for</span> <span class="ex">i</span> in <span class="kw">`</span><span class="fu">cat</span> scaff<span class="kw">`;</span> <span class="kw">do</span> <span class="ex">samtools</span> faidx 2000kb.fa <span class="va">$i</span> <span class="op">&gt;&gt;</span>16S_2Kb.fna<span class="kw">;</span> <span class="kw">done</span></span></code></pre></div>
<p>The extracted sequence where then uploaded to Blast and Silva website to identify the bacteria to which those sequence belong.</p>
</div>
<div id="gtdbtk" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> GTDBTK</h2>
<p><a href="https://github.com/Ecogenomics/GTDBTk/blob/stable/README.md">Github</a></p>
<p>In the folder with all your clean and completed genomes run this command with nohup</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb80-1"><a href="bin-taxonomy.html#cb80-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb80-2"><a href="bin-taxonomy.html#cb80-2"></a><span class="ex">gtdbtk</span> classify_wf --cpus 20 --genome_dir /home/karine/Bins/all_clean --out_dir gtdbk_output</span></code></pre></div>
<p>Once it is done running, you can open the folder called <code>gtdbk_output</code> and copy the folder <code>gtdbtk.bac120.summary.tsv</code> to your local computer in order to open it with excel. Use this folder to identify the phylum, class, order, family and genus that you need to download in order to construct your tree.</p>
</div>
<div id="onecodex" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> OneCodeX</h2>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bin-cleaning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="phylogenetic-tree.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["My research.pdf", "My research.epub"],
"toc": {
"collapse": "subsection",
"edit": "https://github.com/rstudio/bookdown-demo/edit/master/%s"
}
});
});
</script>

</body>

</html>
