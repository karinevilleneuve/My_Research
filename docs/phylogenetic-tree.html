<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 15 PHYLOGENETIC TREE | Protocol</title>
  <meta name="description" content="Section 15 PHYLOGENETIC TREE | Protocol" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 15 PHYLOGENETIC TREE | Protocol" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 15 PHYLOGENETIC TREE | Protocol" />
  
  
  

<meta name="author" content="Karine Villeneuve" />


<meta name="date" content="2020-11-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bin-taxonomy.html"/>
<link rel="next" href="metabolic-pathway.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Research Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i><b>1.1</b> About me</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="host-bookdown-on-github.html"><a href="host-bookdown-on-github.html"><i class="fa fa-check"></i><b>2</b> Host Bookdown on Github</a>
<ul>
<li class="chapter" data-level="2.1" data-path="host-bookdown-on-github.html"><a href="host-bookdown-on-github.html#getting-bookdown-started"><i class="fa fa-check"></i><b>2.1</b> Getting Bookdown started</a></li>
<li class="chapter" data-level="2.2" data-path="host-bookdown-on-github.html"><a href="host-bookdown-on-github.html#github-repository"><i class="fa fa-check"></i><b>2.2</b> Github Repository</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Methods</a></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a>
<ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="6" data-path="cheat-sheet.html"><a href="cheat-sheet.html"><i class="fa fa-check"></i><b>6</b> Cheat sheet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cheat-sheet.html"><a href="cheat-sheet.html#hello-world"><i class="fa fa-check"></i><b>6.1</b> Hello world</a></li>
<li class="chapter" data-level="6.2" data-path="cheat-sheet.html"><a href="cheat-sheet.html#scp"><i class="fa fa-check"></i><b>6.2</b> SCP</a></li>
<li class="chapter" data-level="6.3" data-path="cheat-sheet.html"><a href="cheat-sheet.html#vizbin"><i class="fa fa-check"></i><b>6.3</b> Vizbin</a></li>
<li class="chapter" data-level="6.4" data-path="cheat-sheet.html"><a href="cheat-sheet.html#vi"><i class="fa fa-check"></i><b>6.4</b> vi</a></li>
<li class="chapter" data-level="6.5" data-path="cheat-sheet.html"><a href="cheat-sheet.html#terminal-shortcuts"><i class="fa fa-check"></i><b>6.5</b> Terminal shortcuts</a></li>
<li class="chapter" data-level="6.6" data-path="cheat-sheet.html"><a href="cheat-sheet.html#script-to-remove-sequences-from-a-file"><i class="fa fa-check"></i><b>6.6</b> Script to remove sequences from a file</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scp-1.html"><a href="scp-1.html"><i class="fa fa-check"></i><b>7</b> SCP</a></li>
<li class="chapter" data-level="8" data-path="interleaving.html"><a href="interleaving.html"><i class="fa fa-check"></i><b>8</b> INTERLEAVING</a>
<ul>
<li class="chapter" data-level="8.1" data-path="interleaving.html"><a href="interleaving.html#interleaving-1"><i class="fa fa-check"></i><b>8.1</b> Interleaving</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="interleaving.html"><a href="interleaving.html#run-script"><i class="fa fa-check"></i><b>8.1.1</b> Run script</a></li>
<li class="chapter" data-level="8.1.2" data-path="interleaving.html"><a href="interleaving.html#obtaining-script"><i class="fa fa-check"></i><b>8.1.2</b> Obtaining script</a></li>
<li class="chapter" data-level="8.1.3" data-path="interleaving.html"><a href="interleaving.html#script"><i class="fa fa-check"></i><b>8.1.3</b> Script</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="interleaving.html"><a href="interleaving.html#sickle"><i class="fa fa-check"></i><b>8.2</b> Sickle</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="interleaving.html"><a href="interleaving.html#about"><i class="fa fa-check"></i><b>8.2.1</b> About</a></li>
<li class="chapter" data-level="8.2.2" data-path="interleaving.html"><a href="interleaving.html#exemple"><i class="fa fa-check"></i><b>8.2.2</b> Exemple</a></li>
<li class="chapter" data-level="8.2.3" data-path="interleaving.html"><a href="interleaving.html#bash-script"><i class="fa fa-check"></i><b>8.2.3</b> Bash script</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="interleaving.html"><a href="interleaving.html#quality-check-with-fastqc"><i class="fa fa-check"></i><b>8.3</b> Quality Check with Fastqc</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="interleaving.html"><a href="interleaving.html#about-1"><i class="fa fa-check"></i><b>8.3.1</b> About</a></li>
<li class="chapter" data-level="8.3.2" data-path="interleaving.html"><a href="interleaving.html#exemple-1"><i class="fa fa-check"></i><b>8.3.2</b> Exemple</a></li>
<li class="chapter" data-level="8.3.3" data-path="interleaving.html"><a href="interleaving.html#bash"><i class="fa fa-check"></i><b>8.3.3</b> Bash</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="interleaving.html"><a href="interleaving.html#fastq-to-fasta-with-seqtk"><i class="fa fa-check"></i><b>8.4</b> Fastq to fasta with seqtk</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="assembly.html"><a href="assembly.html"><i class="fa fa-check"></i><b>9</b> ASSEMBLY</a>
<ul>
<li class="chapter" data-level="9.1" data-path="assembly.html"><a href="assembly.html#idba"><i class="fa fa-check"></i><b>9.1</b> IDBA</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="assembly.html"><a href="assembly.html#about-2"><i class="fa fa-check"></i><b>9.1.1</b> About</a></li>
<li class="chapter" data-level="9.1.2" data-path="assembly.html"><a href="assembly.html#bash-script-1"><i class="fa fa-check"></i><b>9.1.2</b> Bash script</a></li>
<li class="chapter" data-level="9.1.3" data-path="assembly.html"><a href="assembly.html#exemple-2"><i class="fa fa-check"></i><b>9.1.3</b> Exemple</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="assembly.html"><a href="assembly.html#megahit"><i class="fa fa-check"></i><b>9.2</b> Megahit</a></li>
<li class="chapter" data-level="9.3" data-path="assembly.html"><a href="assembly.html#metaspades"><i class="fa fa-check"></i><b>9.3</b> metaSPAdes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html"><i class="fa fa-check"></i><b>10</b> POST ASSEMBLY STATS</a>
<ul>
<li class="chapter" data-level="10.1" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#number-of-contigs"><i class="fa fa-check"></i><b>10.1</b> Number of contigs</a></li>
<li class="chapter" data-level="10.2" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#lenght-of-contigs"><i class="fa fa-check"></i><b>10.2</b> Lenght of contigs</a></li>
<li class="chapter" data-level="10.3" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#histogram"><i class="fa fa-check"></i><b>10.3</b> Histogram</a></li>
<li class="chapter" data-level="10.4" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#lenght-and-gc"><i class="fa fa-check"></i><b>10.4</b> Lenght and GC</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#run-the-script"><i class="fa fa-check"></i><b>10.4.1</b> Run the script</a></li>
<li class="chapter" data-level="10.4.2" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#obtainning-script-from-midgard"><i class="fa fa-check"></i><b>10.4.2</b> obtainning script from Midgard</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="post-assembly-stats.html"><a href="post-assembly-stats.html#keeping-sequence-above-2000kb"><i class="fa fa-check"></i><b>10.5</b> Keeping sequence above 2000kb</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="binning.html"><a href="binning.html"><i class="fa fa-check"></i><b>11</b> BINNING</a>
<ul>
<li class="chapter" data-level="11.1" data-path="binning.html"><a href="binning.html#mapping"><i class="fa fa-check"></i><b>11.1</b> Mapping</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="binning.html"><a href="binning.html#ve"><i class="fa fa-check"></i><b>11.1.1</b> VE</a></li>
<li class="chapter" data-level="11.1.2" data-path="binning.html"><a href="binning.html#manual"><i class="fa fa-check"></i><b>11.1.2</b> manual</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="binning.html"><a href="binning.html#depth-file"><i class="fa fa-check"></i><b>11.2</b> Depth file</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="binning.html"><a href="binning.html#run-the-script-1"><i class="fa fa-check"></i><b>11.2.1</b> Run the script</a></li>
<li class="chapter" data-level="11.2.2" data-path="binning.html"><a href="binning.html#copy-file-from-midgard-to-asgard"><i class="fa fa-check"></i><b>11.2.2</b> Copy file from Midgard to Asgard</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="binning.html"><a href="binning.html#metabat"><i class="fa fa-check"></i><b>11.3</b> MetaBAT</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bin-quality.html"><a href="bin-quality.html"><i class="fa fa-check"></i><b>12</b> BIN QUALITY</a></li>
<li class="chapter" data-level="13" data-path="bin-cleaning.html"><a href="bin-cleaning.html"><i class="fa fa-check"></i><b>13</b> BIN CLEANING</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bin-cleaning.html"><a href="bin-cleaning.html#mm-genome"><i class="fa fa-check"></i><b>13.1</b> MM Genome</a></li>
<li class="chapter" data-level="13.2" data-path="bin-cleaning.html"><a href="bin-cleaning.html#vizbin-1"><i class="fa fa-check"></i><b>13.2</b> Vizbin</a></li>
<li class="chapter" data-level="13.3" data-path="bin-cleaning.html"><a href="bin-cleaning.html#depth-file-1"><i class="fa fa-check"></i><b>13.3</b> Depth file</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html"><i class="fa fa-check"></i><b>14</b> BIN TAXONOMY</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html#barrnap"><i class="fa fa-check"></i><b>14.1</b> Barrnap</a></li>
<li class="chapter" data-level="14.2" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html#gtdbtk"><i class="fa fa-check"></i><b>14.2</b> GTDBTK</a></li>
<li class="chapter" data-level="14.3" data-path="bin-taxonomy.html"><a href="bin-taxonomy.html#onecodex"><i class="fa fa-check"></i><b>14.3</b> OneCodeX</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html"><i class="fa fa-check"></i><b>15</b> PHYLOGENETIC TREE</a>
<ul>
<li class="chapter" data-level="15.1" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#download-reference-genomes"><i class="fa fa-check"></i><b>15.1</b> Download reference genomes</a></li>
<li class="chapter" data-level="15.2" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#phylosift"><i class="fa fa-check"></i><b>15.2</b> Phylosift</a></li>
<li class="chapter" data-level="15.3" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#geneious"><i class="fa fa-check"></i><b>15.3</b> Geneious</a></li>
<li class="chapter" data-level="15.4" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#raxml"><i class="fa fa-check"></i><b>15.4</b> RAxML</a></li>
<li class="chapter" data-level="15.5" data-path="phylogenetic-tree.html"><a href="phylogenetic-tree.html#itol"><i class="fa fa-check"></i><b>15.5</b> iTOL</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html"><i class="fa fa-check"></i><b>16</b> METABOLIC PATHWAY</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#convert-bins-to-protein-.faa"><i class="fa fa-check"></i><b>16.1</b> Convert bins to protein (.faa)</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#kofamkoala"><i class="fa fa-check"></i><b>16.1.1</b> KofamKoala</a></li>
<li class="chapter" data-level="16.1.2" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#hyddb"><i class="fa fa-check"></i><b>16.1.2</b> HydDB</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#hydrogenase-tree"><i class="fa fa-check"></i><b>16.2</b> Hydrogenase tree</a></li>
<li class="chapter" data-level="16.3" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#mebs"><i class="fa fa-check"></i><b>16.3</b> Mebs</a></li>
<li class="chapter" data-level="16.4" data-path="metabolic-pathway.html"><a href="metabolic-pathway.html#metabolic"><i class="fa fa-check"></i><b>16.4</b> Metabolic</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="other-stuff.html"><a href="other-stuff.html"><i class="fa fa-check"></i><b>17</b> Other Stuff</a>
<ul>
<li class="chapter" data-level="17.1" data-path="other-stuff.html"><a href="other-stuff.html#one-file"><i class="fa fa-check"></i><b>17.1</b> One file</a></li>
<li class="chapter" data-level="17.2" data-path="other-stuff.html"><a href="other-stuff.html#bash-script-2"><i class="fa fa-check"></i><b>17.2</b> Bash script</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Protocol</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="phylogenetic-tree" class="section level1" number="15">
<h1><span class="header-section-number">Section 15</span> PHYLOGENETIC TREE</h1>
<div id="download-reference-genomes" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Download reference genomes</h2>
<ol style="list-style-type: lower-alpha">
<li>Download assembly summary genbank file</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb81-1"><a href="phylogenetic-tree.html#cb81-1"></a><span class="fu">wget</span> ftp://ftp.ncbi.nlm.nih.gov/genomes/genbank/assembly_summary_genbank.txt</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>For each phylum, order, class, family of interest, search in the <a href="https://www.ncbi.nlm.nih.gov/genome/browse#!/overview/">NCBI database</a> and select 10 individuals with the most complete genome. Copy and paste the name and the assembly number in an excel document. From that excel document, coopy the list of assembly in a vi document called ref.txt</p></li>
<li><p>Search for those identifiers in the assembly summary genbank file with the following command ;</p></li>
</ol>
<div class="sourceCode" id="cb82"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb82-1"><a href="phylogenetic-tree.html#cb82-1"></a><span class="kw">for</span> <span class="ex">n</span> in $<span class="kw">`</span><span class="fu">cat</span> ref.txt<span class="kw">`;</span> <span class="kw">do</span> <span class="fu">grep</span> <span class="va">$n</span> assembly_summary_genbank.txt  <span class="kw">|</span> <span class="fu">cut</span> -f 1,7,8,20 <span class="op">&gt;&gt;</span> genomestodownload.tab <span class="kw">;</span> <span class="kw">done</span></span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Modify the paths to download only the fna genomes</li>
</ol>
<div class="sourceCode" id="cb83"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb83-1"><a href="phylogenetic-tree.html#cb83-1"></a><span class="fu">cut</span> -f 4 genomestodownload.tab  <span class="kw">|</span>  <span class="fu">sed</span> <span class="st">&#39;s/$/\/*fna.gz/g&#39;</span> <span class="op">&gt;&gt;</span> ftp.links.txt</span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Download the genomes and unzip the downloaded files</li>
</ol>
<div class="sourceCode" id="cb84"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb84-1"><a href="phylogenetic-tree.html#cb84-1"></a><span class="fu">wget</span> -i ftp.links.txt</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb85-1"><a href="phylogenetic-tree.html#cb85-1"></a><span class="fu">gunzip</span> *.gz</span></code></pre></div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Add the file name next to the orginial header</li>
</ol>
<div class="sourceCode" id="cb86"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb86-1"><a href="phylogenetic-tree.html#cb86-1"></a><span class="kw">for</span> <span class="ex">i</span> in *.fna <span class="kw">;</span> <span class="kw">do</span> <span class="fu">perl</span> -lne <span class="st">&#39;if(/^&gt;(\S+)/){ print &quot;&gt;$1 [$ARGV]&quot;} else{ print }&#39;</span> <span class="va">$i</span> <span class="op">&gt;</span> <span class="va">$i</span>.MF_Ref.fna<span class="kw">;</span> <span class="kw">done</span> </span></code></pre></div>
<ol start="7" style="list-style-type: lower-alpha">
<li><p>Keep only the files that end with _genomic.fna -&gt; you can move all the others to another folder</p></li>
<li><p>Create a new directory and move your files there</p></li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb87-1"><a href="phylogenetic-tree.html#cb87-1"></a><span class="fu">mkdir</span> /home/karine/MF_ref</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb88-1"><a href="phylogenetic-tree.html#cb88-1"></a><span class="fu">mv</span> *MF_Ref.fna /home/karine/MF_ref</span></code></pre></div>
<ol start="8" style="list-style-type: lower-alpha">
<li>Run CheckM</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb89-1"><a href="phylogenetic-tree.html#cb89-1"></a><span class="ex">checkm</span> lineage_wf -x fna /home/karine/MF_ref checkm -f output_table.txt</span></code></pre></div>
<p>Discard the genomes that are not completed.</p>
</div>
<div id="phylosift" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Phylosift</h2>
<p><a href="https://github.com/gjospin/PhyloSift">Githup</a></p>
<p><font color ='red'>Midgard</font></p>
<ol style="list-style-type: lower-alpha">
<li><p>Create a folder containing your completed .fna bins and reference genomes</p></li>
<li><p>Create a vi file named run_phylosift.sh with the following command and run it using <code>nohup ./</code> and <code>&amp;</code></p></li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb90-1"><a href="phylogenetic-tree.html#cb90-1"></a> <span class="co">#!/bin/bash</span></span>
<span id="cb90-2"><a href="phylogenetic-tree.html#cb90-2"></a><span class="fu">find</span> . -maxdepth 1 -name <span class="st">&quot;*.fna&quot;</span> -exec /home/baker/phylosift_v1.0.1/bin/phylosift search --isolate --besthit {} <span class="dt">\;</span></span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Once phylosift is done align the marker genes with the following command using <code>nohup ./</code> and <code>&amp;</code></li>
</ol>
<div class="sourceCode" id="cb91"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb91-1"><a href="phylogenetic-tree.html#cb91-1"></a><span class="fu">find</span> . -maxdepth 1 -name <span class="st">&quot;*.fna&quot;</span> -exec /home/baker/phylosift_v1.0.1/bin/phylosift align --isolate --besthit {} <span class="dt">\;</span></span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Rename and concatenate the aligned marker for both bins</li>
</ol>
<div class="sourceCode" id="cb92"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb92-1"><a href="phylogenetic-tree.html#cb92-1"></a><span class="fu">find</span> . -type f -regex <span class="st">&#39;.*alignDir/concat.updated.1.fasta&#39;</span>   -exec cat {} <span class="dt">\;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/\.1\..*//&#39;</span>  <span class="op">&gt;</span> name_of_bin_alignmnet.fasta</span></code></pre></div>
</div>
<div id="geneious" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Geneious</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Download Geneious software (free 14 days trial) select <code>new foler</code> drag and drop the aligned fasta file</p></li>
<li><p>Select <code>Align/Assemble</code> ; <code>Multiple align MUSCLE Alignment</code> â€¦ ; ok</p></li>
<li><p>Once it is done, remove the bins or sequence that seem too small and re-run <code>Multiple align - MUSCLE Alignment</code></p></li>
<li><p>Once it is done, select the aligned file go to <code>Tools</code> ; <code>Mask Align</code></p></li>
<li><p>Export the file : <code>File</code> ; <code>Export</code> ; <code>Selected Documents</code> ; <code>Phylip alignment (*phy)</code></p></li>
<li><p>Move the file from your local computer to the server</p></li>
</ol>
</div>
<div id="raxml" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> RAxML</h2>
<p><a href="https://github.com/stamatak/standard-RAxML">Github</a></p>
<p>In the folder with your .phy file create a vi file named tree.sh with the following command and run it using <code>chmod +x</code> ; <code>nohup ./</code>and <code>&amp;</code></p>
<pre><code>#!/bin/bash

raxmlHPC-PTHREADS-AVX -T 35 -f a -m PROTGAMMAAUTO -N autoMRE -p 12345 -x 12345 -s MF_aligned.phy -n MF_karine</code></pre>
<p>When the tree is done running, copy the file <code>RAxML_bipartitionsBranchLabels.yourfilename</code> to your local computer`</p>
</div>
<div id="itol" class="section level2" number="15.5">
<h2><span class="header-section-number">15.5</span> iTOL</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Create an <a href="https://itol.embl.de/">iTOL</a> account and upload your tree (RAxML_bipartitionsBranchLabels.yourfilename) and visualize the results</p></li>
<li><p>Change the name of all the reference genomes</p></li>
</ol>
<ol style="list-style-type: decimal">
<li>Locate the folder where all the reference genoms are located and using terminal view the content of that foler using <code>ls -l</code></li>
<li>Copy/paste the name into an new tab of the excel document where you have saved the GCA assembly name of the reference genomes.</li>
<li>Use VLOOKUP to match the GCA assembly name of the reference genomes to the organism name</li>
<li>In another tab, copy the (1) column with the orginal name of the iTOL tree and the (2) column containing the matching Organism name (in this order very important)</li>
<li>Copy these two column in a vi file named <code>ref_name_tree</code> in the same folder with your tree</li>
<li>In the same folder create an executable perl script named <code>replace_name.sh</code> to change the name in your tree</li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb94-1"><a href="phylogenetic-tree.html#cb94-1"></a></span>
<span id="cb94-2"><a href="phylogenetic-tree.html#cb94-2"></a><span class="ex">use</span> strict<span class="kw">;</span></span>
<span id="cb94-3"><a href="phylogenetic-tree.html#cb94-3"></a><span class="ex">use</span> warnings<span class="kw">;</span></span>
<span id="cb94-4"><a href="phylogenetic-tree.html#cb94-4"></a></span>
<span id="cb94-5"><a href="phylogenetic-tree.html#cb94-5"></a><span class="ex">my</span> <span class="va">$treeFile</span> = pop<span class="kw">;</span></span>
<span id="cb94-6"><a href="phylogenetic-tree.html#cb94-6"></a><span class="ex">my</span> %taxonomy = map { /(\S+)\<span class="ex">s+</span>(.+)<span class="ex">/</span>; <span class="va">$1</span> =<span class="op">&gt;</span> <span class="va">$2</span> } <span class="op">&lt;&gt;</span>;</span>
<span id="cb94-7"><a href="phylogenetic-tree.html#cb94-7"></a></span>
<span id="cb94-8"><a href="phylogenetic-tree.html#cb94-8"></a><span class="ex">push</span> @ARGV, <span class="va">$treeFile</span><span class="kw">;</span></span>
<span id="cb94-9"><a href="phylogenetic-tree.html#cb94-9"></a></span>
<span id="cb94-10"><a href="phylogenetic-tree.html#cb94-10"></a><span class="kw">while</span> <span class="kw">(</span> <span class="ex">my</span> <span class="va">$line</span> = <span class="op">&lt;&gt;</span> <span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb94-11"><a href="phylogenetic-tree.html#cb94-11"></a>   <span class="va">$line</span> =<span class="ex">~</span> <span class="ex">s</span>/\<span class="ex">b</span><span class="va">$_</span>\b/<span class="va">$taxonomy</span><span class="dt">{</span><span class="va">$_</span><span class="dt">}</span>/g for keys %taxonomy<span class="kw">;</span></span>
<span id="cb94-12"><a href="phylogenetic-tree.html#cb94-12"></a>   <span class="ex">print</span> <span class="va">$line</span><span class="kw">;</span></span>
<span id="cb94-13"><a href="phylogenetic-tree.html#cb94-13"></a><span class="kw">}</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Run the perl script</li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb95-1"><a href="phylogenetic-tree.html#cb95-1"></a><span class="fu">perl</span> replace_name.sh ref_name_tree RAxML_bipartitionsBranchLabels.MF_karine <span class="op">&gt;</span> new_tree_name</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Upload the new created tree to iTOL</li>
</ol>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bin-taxonomy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metabolic-pathway.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["My research.pdf", "My research.epub"],
"toc": {
"collapse": "subsection",
"edit": "https://github.com/rstudio/bookdown-demo/edit/master/%s"
}
});
});
</script>

</body>

</html>
